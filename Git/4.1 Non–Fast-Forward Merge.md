### Core Concept

To understand a non–fast-forward merge, start with its opposite: **fast-forward (FF)**.

- **When FF happens:** You want to merge branch **B** into branch **A**, and since **A** has **no new commits** since **B** branched off, Git can simply “fast-forward” **A**’s pointer (HEAD) to the tip of **B**. No new commit is created.
    
- **Result:** The history is a straight line; you can’t easily tell a branch ever existed or that a merge happened.


### Example

Assume a repository with `master` and a feature branch `feature/login`.

**Initial state**  
At commit `C2`, you branch off `feature/login` from `master`:

```
          (feature/login)
              |
C0 --- C1 --- C2
              |
           (master)
```

**After some development**  
You make two commits on `feature/login` (`C3`, `C4`), while no one commits to `master`:

```
                C3 --- C4 (feature/login)
              /
C0 --- C1 --- C2
              |
           (master)
```

Now you need to merge `feature/login` back into `master`.

#### 1) Fast-Forward Merge (default) — `git merge feature/login`

Because `master` at `C2` is an ancestor of `feature/login`, Git performs a fast-forward.

**After merge:**  
Git simply moves `master` to `C4`.

```
C0 --- C1 --- C2 --- C3 --- C4 (master, feature/login)
```

**Issue:** The history is a straight line. You cannot see from the log that `C3` and `C4` were developed on a branch named `feature/login`. Important context is lost.

#### 2) Non–Fast-Forward Merge — `git merge --no-ff feature/login`

With `--no-ff`, Git **forces a new merge commit** even though a fast-forward is possible.

**After merge:**  
Git creates a new commit `M5` with two parents: the old `master` tip `C2` and the feature tip `C4`.

```
                C3 --- C4 (feature/login)
              /           \
C0 --- C1 --- C2 ---------- M5 (master)
```

**Advantages:**

- **History topology preserved:** `git log --graph` clearly shows a branch starting at `C2`, work on `C3`/`C4`, and a merge at `M5`.
    
- **Context is clear:** The merge commit message (e.g., “Merge feature/login: Added user authentication and OAuth support.”) documents the intent and scope of the change.
    
- **Operationally convenient:** To roll back the **entire feature**, you can revert the merge commit as a unit:  
    `git revert -m 1 M5`  
    Git knows `M5` encapsulates the set of changes (`C3` and `C4`) and can undo them together.

### Side-by-Side Summary

| Aspect                   | Fast-Forward (FF)       | Non–Fast-Forward (`--no-ff`)     |
| :----------------------- | :---------------------- | :------------------------------- |
| **History shape**        | Straight line           | Branch + merge visible           |
| **Creates new commit**   | No                      | **Yes** (a merge commit)         |
| **Context preservation** | Branch context lost     | **Branch context retained**      |
| **Typical use**          | Small, simple bug fixes | **Feature merges**, **releases** |
| **Rollback**             | Revert multiple commits | **Revert a single merge commit** |
