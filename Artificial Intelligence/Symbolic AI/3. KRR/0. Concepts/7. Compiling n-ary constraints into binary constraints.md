```python
def main():
    args = process_command_line_arguments()
    input_path = args.input
    output_path = args.output
    variables, constraints = parse_nary_file(input_path)

    new_variables = {}
    new_constraints = []

    for constraint in constraints:
        vs, values = constraint

        if len(vs) == 2:
            new_constraints.append(constraint)
            continue

        aux_domain = set()
        for v in variables[vs[0]]:
            for w in variables[vs[1]]:
                aux_domain.add((v, w))

        aux_var = 'aux_{}_{}'.format(vs[0], vs[1])
        new_variables[aux_var] = aux_domain

        for i in range(2, len(vs)):
            curr_var = vs[i]
            curr_domain = variables[curr_var]
            new_vs = (aux_var, curr_var)
            new_values = []
            for val in curr_domain:
                for aux_val in aux_domain:
                    if aux_val[0] + aux_val[1] == val:
                        new_values.append(aux_val + (val,))
            new_constraints.append((new_vs, new_values))

    with open(output_path, 'w') as f:
        for var, domain in new_variables.items():
            f.write('var {}: {}\n'.format(var, ' '.join(sorted(domain))))

        for vs, values in new_constraints:
            f.write('con {}: {}\n'.format(' '.join(vs), ' '.join(sorted(values))))
```


```python
def main():
    args = process_command_line_arguments()
    input_path = args.input
    output_path = args.output
    variables, constraints = parse_nary_file(input_path)

    new_variables = {}
    new_constraints = []

    for constraint in constraints:
        vs, values = constraint

        if len(vs) == 2:
            new_constraints.append(constraint)
            continue

        aux_vars = []
        aux_domains = []
        for i in range(len(vs) - 1):
            curr_var = vs[i]
            next_var = vs[i+1]
            curr_domain = variables[curr_var]
            next_domain = variables[next_var]
            aux_domain = set()
            for val1 in curr_domain:
                for val2 in next_domain:
                    aux_domain.add(val1 + " " + val2)
            aux_var = "aux_" + curr_var + "_" + next_var
            new_variables[aux_var] = aux_domain
            aux_vars.append(aux_var)
            aux_domains.append(aux_domain)

        new_vs = tuple([aux_vars[0], vs[-1]])
        new_values = []
        for val in variables[vs[-1]]:
            for aux_val in aux_domains[-1]:
                if check_constraint(aux_val + " " + val):
                    new_values.append(aux_val.split() + (val,))
        new_constraints.append((new_vs, new_values))

        for i in range(1, len(aux_vars)):
            curr_var = aux_vars[i]
            prev_var = aux_vars[i-1]
            curr_domain = aux_domains[i]
            prev_domain = aux_domains[i-1]
            new_vs = (prev_var, curr_var)
            new_values = []
            for val in curr_domain:
                for aux_val in prev_domain:
                    if check_constraint(aux_val + " " + val):
                        new_values.append(aux_val.split() + val.split())
            new_constraints.append((new_vs, new_values))

    with open(output_path, 'w') as f:
        for var, domain in new_variables.items():
            f.write('var {}: {}\n'.format(var, ' '.join(sorted(domain))))

        for vs, values in new_constraints:
            f.write('con {}: {}\n'.format(' '.join(vs), ' '.join(sorted(values))))

```