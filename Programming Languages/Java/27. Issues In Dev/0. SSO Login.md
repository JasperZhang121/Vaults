### Workflow of SSO

1. **Initiate Login**  
    User attempts to access the application → Redirect to the Authorization Server (`Auth URL`) with parameters: `client_id`, `redirect_uri`, `scope`, etc.
    
2. **User Authorization**  
    User signs in and grants consent on the Authorization Server → Authorization Server redirects back to the application’s `redirect_uri`, including an authorization **code**.
    
3. **Token Exchange**  
    Application sends the **code** to the Token Endpoint (`Token URL`) using a POST request → Receives an **access_token** (and optional **refresh_token**).
    
4. **Fetch User Info**  
    Application calls the UserInfo Endpoint (`UserInfo URL`) with the **access_token** → Retrieves user profile data.
    
5. **Establish Local Session**  
    Map returned fields to your user model → Create a local session or issue a JWT → User is now authenticated in the application, and all subsequent requests use the local session/JWT.
    
![[sso.png]]


### OAuth2 Configuration Basics

- **Name**  
    A unique identifier for this OAuth2 client (e.g., `google`, `github`).
    
- **Client ID / Client Secret**  
    Credentials issued by the Identity Provider (IdP).
    
- **Domain**  
    The IdP’s base URL (e.g., `accounts.google.com`).
    
- **Redirect URI**  
    Application endpoint to receive the authorization code (e.g., `http://jasper.example.com/oauth/callback`).
    
- **Auth URL**  
    Endpoint to initiate authorization (e.g., `https://accounts.google.com/o/oauth2/v2/auth`).
    
- **Token URL**  
    Endpoint to exchange code for tokens (e.g., `https://oauth2.googleapis.com/token`).
    
- **UserInfo URL**
    Endpoint to fetch user profile (e.g., `https://www.googleapis.com/oauth2/v2/userinfo`).
    
- **Scopes**  
    Space-separated list of requested permissions (e.g., `openid profile email`).
    
- **Grant Type**  
    Typically `authorization_code`, using a POST to exchange the code.
    
- **UserInfo Mapping**  
    Map returned JSON fields (e.g., `email`, `name`) into your application’s user schema.