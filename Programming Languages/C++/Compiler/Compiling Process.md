----

A compiler is a program that reads a program written in one language (the source language) and translates that program into an equivalent program written in another language (the target language) .

The process of converting a program into an executable program by the C/C++ compilation system includes:
- Preprocessing:
	Modifying the content of the source file according to the preprocessing directives in the placed file.
- Compilation: 
	Through lexical analysis and syntax analysis, after confirming that all instructions conform to the grammatical rules, they are translated into equivalent intermediate code representation or assembly code.
- Assembly: 
	The process of translating assembly language code into target machine instructions.
- Linking: 
	Find the object files where all the functions used are located, and link them together to form an executable file.


---

Preprocessing
A preprocessor is a program that processes a program source file according to preprocessing instructions before the program source file is compiled. Preprocessor directives start with a # sign and do not contain a semicolon at the end. Preprocessing commands are not part of the C/C++ language itself, and they cannot be compiled and linked directly. An important function of the C/C++ language is that preprocessing instructions and preprocessing functions can be used. The preprocessing functions provided by C/C++ mainly include file inclusion, macro replacement, and conditional compilation.

```C++
#include <xxx.h>    // serach from root
#include "xxx.h"    // search from source then root
```

```shell
g++ -E test.cpp -o test.i
```

----
Compilation: 
Enter the stream of characters that make up the source program and organize them into a sequence of meaningful morphemes. For each morpheme, the lexical analyzer generates a token, which is passed to the next step: syntax analysis.
A commonly used representation method is a syntax tree, each internal node in the tree represents an operation, and the child nodes of the node represent the components of the operation.
Next is the semantic analyzer, which uses information in the syntax tree and symbol table to detect whether the source program is consistent with the semantics defined by the language.
This is generally followed by a machine-independent code optimization step that attempts to improve the intermediate code in order to generate better object code.

```shell
g++ -S test.i -o test.s
```

----
Assembly:
For each C/C++ language source program processed by the translation system, the corresponding target file will be finally obtained through this processing. What is stored in the object file is the target machine language code equivalent to the source program. Object files are made up of segments, and usually there are at least two segments in an object file: the code segment and the data segment.

Code segment: This segment contains mainly program instructions. This section is generally readable and executable, but generally not writable.
Data segment: mainly stores various global variables or static data to be used in the program. General data segments are readable, writable, and executable.


```shell
g++ -c test.s -o test.o
```

---
Linking: 
The main job of the linker is to connect the related object files to each other, that is, to connect the symbol referenced in one file with the definition of the symbol in another file, so that all these object files become a file that can be installed according to the operating system. into a unified whole:
- Static linking: In the linking stage, the object file .o generated by assembly will be linked and packaged into the executable file together with the referenced library, and the static library file is no longer needed when the program is running.
- Dynamic linking: Link information such as the file module (DLL) where the called function is located and the location of the called function in the file into the target program. When the program is running, it will find the corresponding function code from the DLL, so the support of the corresponding DLL file is required.


```shell
g++ test.o -o test
```

